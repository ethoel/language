<template name="atlas">
  <div id="main_id">

  <a href="#" class="menu-toggle notadmin">
      <img class="toggle-icon" src="/menu_c7c7c7_round.png" alt="menu" height="26" width="26">
  </a>
    

  
  
    <nav id="menu-side-id" class="menu-side notadmin">
      <!-- title, admin links, list of studies with filters -->
      
        
      
      <div id="filterStudyList">
        <h3 id="catlasNavTitle" class="nav_title">Catlas</h3>
        <div id="adminDiv">
          <a href="/edit" class="smallcatlaslink catlasLink">Contribute</a>
        </div>
        
        <div id="filterDiv">
          <div class="filterCheckboxSetDiv">
            
            <input type="checkbox" id="normalCheckbox" class="filterCheckbox" checked>
            <label for="normalCheckbox">Normal</label>

            <input type="checkbox" id="abnormalCheckbox" class="filterCheckbox" checked>
            <label for="abnormalCheckbox">Abnormal</label>
            <a href="#" id="moreFilters">More filters...</a>
          </div>
        </div>

        <div id="currentStudiesList">
<!--          <span id="noStudiesText">No studies matching filter criteria</span>-->
          <ul id="nav-list-id" class="nav-list">
            {{#each filteredStudies}}
            {{> filteredStudy}}
            {{/each}}
          </ul>
        </div>
      </div>
      

      
      <!-- list of organs -->
      <div id="currentOrganList">
        <ul id="organs">{{#each organs}}{{> organ}}{{/each}}</ul>
      </div>
    </nav>

  
    <div id="study-pane">
  
  

    
  <div id="canvas-container">
    
    
    
    
    <h3 id="study_title_id" class="study_title">{{studyTitle}}</h3>
    <canvas id="canvas" onclick=""></canvas>
    
        <a href="#" class="help-button notadmin">
      <img class="help-icon" src="/help_c7c7c7_round.png" alt="help" height="26" width="26">
  </a>
        <h3 id="organ_title_id" class="organ_title">{{hoverOrgan}}</h3>
  
      <div id="study-description" class="notadmin">{{{studyDescription}}}</div>
  </div>
  
  

  </div>
  
  <!-- get rid of this
  <input type="text" id="currentStudy" value="Normal"/>
 -->
  

  
<!--
  {{#contentFor "admin"}}

 
  
  
  
  {{/contentFor}}
-->
  
<!--  {{> contentFor region="admin" template="controlPanel"}}-->
    {{> contentFor region="admin" template="controlPanel"}}

  </div>
</template>

<template name="controlPanel">
  
  <head>
    <style type="text/css">
    #main_id {
  position: static !important;
  bottom: auto !important;
  overflow: auto !important;
}

#study-pane {
  position: static !important;
  bottom: auto !important;
  overflow: auto !important;
} 
      
.notadmin {
  display: none;
} 
      
      body {
        overflow-x: auto !important;
      }
    </style>
  </head>
  
  <div class="structureEditingPane">
    
    <h3 class="study_title">Editing {{studyName}} structures</h3>
    <a href="/preview/{{studyOwner}}/{{studyName}}" class="catlasLink" style="display: block; text-align: center; margin-bottom: 5px; width: 100%">Preview</a>
    
    <div class="editUnit">
      <p >
        <span class="editLabel tooltip">Create new structure
          <span class="tooltiptext">Enter a name and click "New structure" to create and begin editing a new structure
          </span>
        </span>
        <input type="text" id="currentOrgan" placeholder="New structure name"/>
        <button id="saveCurrentOrgan" class="saveButton">New structure</button>
      </p>

      <p> 
        <span class="tooltip editLabel">Current structure
          <span class="tooltiptext">Select a structure to edit from the dropdown menu</span>
        </span>
        <select id="currentOrganDrop" style="display: inline-block">
          {{#each organs}}
          {{> organdrop}}
          {{/each}}
        </select>
        

        <span class="organLabel" style="cursor: pointer; background-color: {{currentEditingColorText}}; display: inline-block">
          <input style="cursor: pointer" id="loneCheckBox" class="organCheckBox" type="checkbox" value="{{currentOrgan}}"/>
        </span>
      </p>
    </div>
    
    <div class="editUnit">
      <h4>Edit Current Structure</h4>

      <p>
        <span class="tooltip editLabel">Rename current structure
          <span class="tooltiptext">Enter a new name and click "Rename" to rename structure named "{{currentOrgan}}"</span>
        </span>
        <input type="text" id="renameStructureText" placeholder="New name" value="{{currentStructure}}"/>
        <button id="renameCurrentOrgan" class="saveButton">Rename</button>
      </p>

      <p>
        <span class="tooltip editLabel">Delete current structure
          <span class="tooltiptext">To permanently delete structure named "{{currentOrgan}}," click "Delete structure"</span>
        </span>
        <button id="deleteCurrentOrgan" class="deleteButton">Delete structure</button>
      </p>

      <p>
        <span class="tooltip editLabel">Edit description of current structure
          <span class="tooltiptext">Make any changes to the description of structure named "{{currentOrgan}}" in the box below and click "Save description" to save the changes</span>
        </span>
        <textarea id="organ-description" placeholder="Organ description"  rows="3" value="{{currentStructureDescription}}"></textarea>
        <button id="saveOrganDescription" class="saveButton" style="display: block">Save description</button>
      </p>
    </div>
    
    
    
    <div class="editUnit">
      <h4>Edit Highlighting</h4>

      <p>
        <span class="tooltip editLabel">Add new highlighting of current structure to image
          <span class="tooltiptext">Click and drag the mouse on the image to the left to outline and highlight structure named "{{currentOrgan}}" on this image with the specified color. Use the controls below save or cancel any changes for this image. Change color and transparency by using the color picker and slider, or typing a color in and pressing the enter key</span>
        </span>
        <button id="clear" style="display: block; margin-bottom: 2px">Clear new highlighting</button>
        <input type="color" id="colorpickerbutton" value="{{currentEditingColorNoAlpha}}"/>
        <input type="range" id="transparencyPicker" value="{{currentEditingColorAlpha}}"/>
        <input type="text" id="colorpicker" value="{{currentEditingColorText}}" onkeypress="if (event.keyCode == 13) document.getElementById('changeColor').click()"/>
        <button id="changeColor" style="display: none" value="{{currentOrganColor}}">Change Color</button>
        <button id="resetColor">Reset</button>
        <button id="save" style="display: block; margin-top: 5px">Save new highlighting</button>
      </p>

      <p>
        <span class="tooltip editLabel">Delete highlighting of current structure from image
          <span class="tooltiptext">To permanently delete all highlighting of the structure named "{{currentStructure}}" on this image, click "Delete highlighting" below</span>
        </span>
        <button id="clearAll">Delete highlighting</button>
      </p>
    </div>
    
    <div class="editUnit">
      <ul id="organsEdit">{{#each organs}}{{> organ}}{{/each}}</ul>
    </div>
  </div>
</template>

<template name="organ"><li>
<label  style="cursor: pointer">
<span class="organLabel" style="cursor: pointer; background-color:{{color}}">
  <input style="cursor: pointer" class="organCheckBox" type="checkbox" value="{{this.organ}}" {{checked this.organ}}/>
</span>
  {{this.organ}}
  </label>
<!--  <label for="organCheckBox">{{this.organ}}</label>-->
<!--    <input type="checkbox" {{checked}}/>{{organ}}-->
  
</li></template>

<template name="organdrop">
  <option value="{{this.organ}}">{{this.organ}}</option>
</template>

<template name="filteredStudy">
  <li class="studyListItem"><a class="filteredStudyLink" href="{{this.name}}">{{this.title}}</a></li>
</template>